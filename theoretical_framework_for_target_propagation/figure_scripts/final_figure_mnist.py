config_DTP = {
'lr': 6.185037324617764e-05,
'target_stepsize': 0.21951187497378802,
'beta1': 0.9,
'beta2': 0.999,
'epsilon': 1.0170111936290766e-08,
'lr_fb': 0.0019584756448113774,
'sigma': 0.08372453893037193,
'beta1_fb': 0.9,
'beta2_fb': 0.999,
'epsilon_fb': 7.541132645747324e-06,
'out_dir': 'logs/mnist/DTP',
'network_type': 'DTP',
'initialization': 'xavier_normal',
'fb_activation': 'tanh',
'extra_fb_epochs': 0,
'epochs_fb': 0,
'gn_damping': [10.,10.,1.,1.,0.01],
}

config_DKDTP2_rec_extrafb = {
'lr': 6.530289454184444e-05,
'target_stepsize': 0.03391776356880856,
'beta1': 0.9,
'beta2': 0.9,
'epsilon': 1.408840589359605e-08,
'lr_fb': 3.055525874735466e-05,
'sigma': 0.06379589790297038,
'feedback_wd': 0.0030391271787456268,
'beta1_fb': 0.999,
'beta2_fb': 0.999,
'epsilon_fb': 9.348498204704435e-07,
'out_dir': 'logs/mnist/DKDTP2',
'network_type': 'DKDTP2',
'recurrent_input': True,
'hidden_fb_activation': 'tanh',
'fb_activation': 'tanh',
'initialization': 'xavier_normal',
'size_hidden_fb': 1024,
'extra_fb_epochs': 4,
'epochs_fb': 10,
'gn_damping': [1.,1.,1.,1.,0.0001],
}

config_DTP_improved = {
'lr': 8.755114977760993e-05,
'target_stepsize': 0.29588215061609174,
'feedback_wd': 0.002191969471427704,
'beta1': 0.9,
'beta2': 0.99,
'epsilon': 1.3539369588818846e-07,
'lr_fb': 0.00046353371500045345,
'sigma': 0.17295321576257636,
'beta1_fb': 0.9,
'beta2_fb': 0.9,
'epsilon_fb': 4.3671895272055226e-07,
'out_dir': 'logs/mnist/DTP_improved',
'network_type': 'DTP',
'initialization': 'xavier_normal',
'fb_activation': 'tanh',
'extra_fb_epochs': 1,
'epochs_fb': 6,
'gn_damping': [10.,10.,10.,1.,0.],
}

config_DKDTP2 = {
'lr': 1.8344501197850718e-05,
'target_stepsize': 0.05565828298326246,
'beta1': 0.99,
'beta2': 0.999,
'epsilon': 4.504429689758071e-08,
'lr_fb': 1.0314691826112397e-06,
'sigma': 0.029108018407511767,
'feedback_wd': 1.3213470513982929e-05,
'beta1_fb': 0.999,
'beta2_fb': 0.999,
'epsilon_fb': 8.41113837941681e-06,
'out_dir': 'logs/mnist/DKDTP2',
'network_type': 'DKDTP2',
'recurrent_input': False,
'hidden_fb_activation': 'tanh',
'fb_activation': 'tanh',
'initialization': 'xavier_normal',
'size_hidden_fb': 1024,
'extra_fb_epochs': 1,
'epochs_fb': 6,
'gn_damping': [1.,1.,1.,1.,0.0001],
}

config_DKDTP2_extrafb = {
'lr': 0.00497884765761932,
'target_stepsize': 0.031803317994129734,
'beta1': 0.9,
'beta2': 0.99,
'epsilon': 0.00011423747064362681,
'lr_fb': 1.1810601875614817e-06,
'sigma': 0.08807753575899523,
'feedback_wd': 0.005158844217972975,
'beta1_fb': 0.999,
'beta2_fb': 0.99,
'epsilon_fb': 1.272047944960225e-07,
'out_dir': 'logs/mnist/DKDTP2',
'network_type': 'DKDTP2',
'recurrent_input': False,
'hidden_fb_activation': 'tanh',
'fb_activation': 'tanh',
'initialization': 'xavier_normal',
'size_hidden_fb': 1024,
'extra_fb_epochs': 4,
'epochs_fb': 10,
'gn_damping': [1.,1.,1.,0.1,0.0001],
}

config_DTPDR = {
'lr': 2.968902530985572e-05,
'target_stepsize': 0.06858850589618244,
'beta1': 0.9,
'beta2': 0.99,
'epsilon': 1.001084429920261e-08,
'lr_fb': 2.0123315498373473e-05,
'sigma': 0.056879454462500055,
'feedback_wd': 5.384963778780523e-06,
'beta1_fb': 0.99,
'beta2_fb': 0.999,
'epsilon_fb': 5.0844503288987736e-08,
'out_dir': 'logs/mnist/DTPDR',
'network_type': 'DTPDR',
'initialization': 'xavier_normal',
'fb_activation': 'tanh',
'extra_fb_epochs': 1,
'epochs_fb': 6,
'gn_damping': [1.,1.,1.,1.,0.0],
}

config_DFA = {
'lr': 0.0003808175281098754,
'beta1': 0.9,
'beta2': 0.999,
'epsilon': 1.0861745402518128e-07,
'out_dir': 'logs/fashion_mnist/DFA',
'network_type': 'DFA',
'fb_activation': 'linear',
'initialization': 'xavier_normal',
'target_stepsize': 1.0,
'extra_fb_epochs': 0,
'epochs_fb': 0,
'gn_damping': [10.,1.,1.,1.,0.01],
}

config_DMLPDTP2_linear = {
'lr': 2.0354415171962153e-05,
'target_stepsize': 0.06096940412767466,
'beta1': 0.9,
'beta2': 0.999,
'epsilon': 1.255238177132068e-08,
'lr_fb': 0.00016378232822128718,
'sigma': 0.0907524824699504,
'feedback_wd': 5.836204840235672e-07,
'beta1_fb': 0.999,
'beta2_fb': 0.999,
'epsilon_fb': 0.0002838378678760835,
'out_dir': 'logs/mnist/DMLPDTP2_linear',
'network_type': 'DMLPDTP2',
'recurrent_input': False,
'hidden_fb_activation': 'linear',
'size_mlp_fb': None,
'fb_activation': 'linear',
'initialization': 'xavier_normal',
'extra_fb_epochs': 1,
'epochs_fb': 6,
'gn_damping': [1.,1.,1.,1.,0.0001],
}

config_BP = {
'lr': 0.0002970474733093798,
'beta1': 0.99,
'beta2': 0.999,
'epsilon': 6.927830087224072e-08,
'out_dir': 'logs/mnist/BP',
'network_type': 'BP',
'initialization': 'xavier_normal',
'target_stepsize': 1.0,
'extra_fb_epochs': 0,
'epochs_fb': 0,
}

config_DDTP_control = {
'lr': 8.882733337430332e-05,
'target_stepsize': 0.09416689927228376,
'beta1': 0.9,
'beta2': 0.999,
'epsilon': 5.552559684258553e-08,
'lr_fb': 0.00018713096100900022,
'sigma': 0.008719996683197298,
'feedback_wd': 0.00040219548415666565,
'beta1_fb': 0.9,
'beta2_fb': 0.999,
'epsilon_fb': 1.2297580110850507e-08,
'out_dir': 'logs/mnist/DDTPControl',
'network_type': 'DDTPControl',
'recurrent_input': False,
'hidden_fb_activation': 'linear',
'size_mlp_fb': None,
'fb_activation': 'linear',
'initialization': 'xavier_normal',
'extra_fb_epochs': 1,
'epochs_fb': 6,
'gn_damping': [10.,1.,1.,0.1,0.1],
}


config_collection = {
'DTPDRL': config_DTPDR,
'DDTP-linear': config_DMLPDTP2_linear,
'DDTP-RHL': config_DKDTP2,
'DDTP-RHL(extra fb)': config_DKDTP2_extrafb,
'DDTP-RHL(rec+extra fb)': config_DKDTP2_rec_extrafb,
'DTP': config_DTP,
'DTP-pretrained': config_DTP_improved,
'DDTP-Control': config_DDTP_control,
'DFA': config_DFA,
'BP': config_BP,
}

result_keys = [
'loss_train',
'loss_test',
'loss_val',
'acc_train',
'acc_test',
'acc_val',
'bp_angles',
'gnt_angles',
'rec_loss',
]

config_fixed = {
'dataset': 'mnist',
'double_precision': True,
'optimizer': 'Adam',
'optimizer_fb': 'Adam',
'momentum': 0.0,
'parallel': True,
'normalize_lr': True,
'batch_size': 128,
'forward_wd': 0.0,
'not_randomized': True,
'not_randomized_fb': True,
'extra_fb_minibatches': 0,
'epochs': 100,
'only_train_first_layer': False,
'train_only_feedback_parameters': False,
'num_hidden': 5,
'size_hidden': 256,
'size_input': 784,
'size_output': 10,
'hidden_activation': 'tanh',
'output_activation': 'softmax',
'no_bias': False,
'no_cuda': False,
'random_seed': 42,
'cuda_deterministic': False,
'freeze_BPlayers': False,
'multiple_hpsearch': False,
'save_logs': True,
'save_BP_angle': True,
'save_GN_angle': False,
'save_GNT_angle': True,
'save_GN_activations_angle': False,
'save_BP_activations_angle': False,
'hpsearch': False,
'plots': 'compute',
'log_interval': 80,
}

if __name__ == '__main__':
	 pass